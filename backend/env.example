# =============================================================================
# Backend Environment Configuration
# =============================================================================
# Copy this file to .env and update the values for your environment.
#   cp env.example .env
# NEVER commit .env to version control - it may contain secrets.
# =============================================================================

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------
# Connection string for the database. Use SQLite for development, PostgreSQL for production.
# Examples:
#   SQLite:     sqlite:///./mfqod.db
#   PostgreSQL: postgresql://user:password@host:5432/dbname
DATABASE_URL=sqlite:///./mfqod.db

# -----------------------------------------------------------------------------
# JWT / Authentication
# -----------------------------------------------------------------------------
# Secret key for signing JWT tokens. MUST be changed in production - use a strong random string.
SECRET_KEY=your-super-secret-jwt-key-change-this-in-production

# JWT token expiry (hours). Default: 8 hours
JWT_EXPIRY_HOURS=8

# Access token expiry in minutes (default: 480 = 8 hours)
ACCESS_TOKEN_EXPIRE_MINUTES=480

# Refresh token expiry in days (default: 7)
REFRESH_TOKEN_EXPIRE_DAYS=7

# -----------------------------------------------------------------------------
# Account Security
# -----------------------------------------------------------------------------
# Maximum failed login attempts before lockout
MAX_LOGIN_ATTEMPTS=5

# Lockout duration in minutes after max attempts exceeded
LOCKOUT_DURATION_MINUTES=30

# Allow external (non-LDAP) users to register
ALLOW_EXTERNAL_REGISTRATION=true

# Require email verification for new external users
REQUIRE_EMAIL_VERIFICATION=true

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
# Login attempts per minute per IP
LOGIN_RATE_LIMIT_PER_MINUTE=5

# API requests per minute (when global rate limit is enabled)
API_RATE_LIMIT_PER_MINUTE=60

# Enable/disable global API rate limiting
ENABLE_GLOBAL_RATE_LIMIT=true

# Public (unauthenticated) API rate limit per minute
PUBLIC_API_RATE_LIMIT_PER_MINUTE=30

# Authenticated API rate limit per minute
AUTHENTICATED_API_RATE_LIMIT_PER_MINUTE=60

# Rate limit window in minutes
RATE_LIMIT_WINDOW_MINUTES=1

# -----------------------------------------------------------------------------
# LDAP / Active Directory Configuration (SQU)
# -----------------------------------------------------------------------------
# LDAP server hostname
AD_SERVER=ldap.squ.edu.om

# LDAP port: 636 for LDAPS (SSL), 389 for LDAP
AD_PORT=636

# Use SSL for LDAP connection
AD_USE_SSL=true

# Use TLS (STARTTLS)
AD_USE_TLS=false

# Base DN for the directory
AD_BASE_DN=DC=squ,DC=edu,DC=om

# Organisational unit for users
AD_USER_DN=OU=Users,DC=squ,DC=edu,DC=om

# Organisational unit for groups
AD_GROUP_DN=OU=Groups,DC=squ,DC=edu,DC=om

# Service account for LDAP binding (get credentials from IT department)
AD_BIND_USER=CN=ServiceAccount,OU=Service Accounts,DC=squ,DC=edu,DC=om
AD_BIND_PASSWORD=your-service-account-password

# LDAP search filters (RFC 2254 compliant). {username} is replaced at runtime.
AD_USER_SEARCH_FILTER=(&(objectClass=person)(sAMAccountName={username}))
AD_GROUP_SEARCH_FILTER=(objectClass=group)

# Connection timeouts (seconds)
AD_CONNECTION_TIMEOUT=30
AD_SEARCH_TIMEOUT=60
AD_MAX_CONNECTIONS=10

# SSL/TLS verification and certificate paths (optional)
AD_VERIFY_SSL=true
AD_SSL_CERT_FILE=
AD_SSL_KEY_FILE=
AD_SSL_CA_FILE=

# Sync settings
AD_SYNC_INTERVAL_HOURS=24
AD_SYNC_BATCH_SIZE=100
AD_ENABLE_AUTO_SYNC=true

# Account status checks
AD_CHECK_ACCOUNT_STATUS=true
AD_DEACTIVATE_EXPIRED_ACCOUNTS=true
AD_DEACTIVATE_DISABLED_ACCOUNTS=true

# Default roles for new users
AD_DEFAULT_INTERNAL_ROLE=student
AD_DEFAULT_EXTERNAL_ROLE=external

# Follow LDAP referrals
AD_FOLLOW_REFERRALS=false

# -----------------------------------------------------------------------------
# Email / SMTP Configuration
# -----------------------------------------------------------------------------
# Enable or disable email sending
EMAIL_ENABLED=true

# SMTP server (e.g. smtp.gmail.com for Gmail)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587

# SMTP credentials. For Gmail, use an App Password (not your regular password).
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-16-character-app-password

# TLS/SSL
SMTP_TLS=true
SMTP_SSL=false

# Sender address and display name
MAIL_FROM=your-email@gmail.com
MAIL_FROM_NAME="SQU Lost & Found System"

# Path to email templates (relative to backend root)
EMAIL_TEMPLATE_DIR=app/templates/email

# Email batch settings (for bulk sending)
EMAIL_BATCH_SIZE=50
EMAIL_BATCH_DELAY=1

# -----------------------------------------------------------------------------
# Frontend URL (for password reset links, etc.)
# -----------------------------------------------------------------------------
# Base URL of the frontend application
FRONTEND_BASE_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
# Debug mode (set to false in production)
DEBUG=false

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO
